# from flask import current_app, g
from entercve import entercve_menu
from modifycve import updatecve_menu
from searchappliance import searchapp_menu
from searchav import searchav_menu
from searchcveid import findcve_menu
from searchscores import searchscores_menu
from wildcardsearch import wildcardsearch_menu
from showcves import show_cves

# TODO: Add display all imports


def option_1():
    print("You chose Option 1")
    findcve_menu()


def option_2():
    print("You chose Option 2")
    searchscores_menu()


def option_3():
    print("You chose Option 3")
    searchapp_menu()


def option_4():
    print("You chose Option 4")
    searchav_menu()


def option_5():
    print("You chose Option 5")
    wildcardsearch_menu()


def option_6():
    print("You chose Option 6")
    show_cves()


def option_7():
    print("You chose Option 7")
    entercve_menu()


def option_8():
    print("You chose Option 8")
    updatecve_menu()


def exit_program():
    print("Exiting...")
    return True


def display_menu():
    print("Welcome to the Command Line Menu")
    print("1. Search CVE-ID")
    print("2. Search Scores")
    print("3. Search Appliance")
    print("4. Search Attack Vector")
    print("5. Wildcard Search")
    print("6. Display All CVEs")
    print("7. Enter New CVE")
    print("8. Modify CVE")
    print("0. Exit")


def main_menu():
    menu_options = {
        "1": option_1,
        "2": option_2,
        "3": option_3,
        "4": option_4,
        "5": option_5,
        "6": option_6,
        "7": option_7,
        "8": option_8,
        "0": exit_program,
    }

    while True:
        display_menu()
        choice = input("Enter your choice (1-8, 0 to exit): ")

        if choice in menu_options:
            should_exit = menu_options[choice]()
            if should_exit:
                break
        else:
            print("Invalid choice. Please choose a number from 0 to 8.")


if __name__ == "__main__":
    main_menu()
