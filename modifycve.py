from jsonreader import import_data
from sqlconnec import update_entry, get_db_connection
from printcolor import *


def option_1():

    cve_id = input("Enter the CVE-ID you wish to update: ")

    print(
        "1. ID  ",
        "2. Name  ",
        "3. Method_of_entry  ",
        "4. Attack_Vector_v3  ",
        "5. text_description\n",
        "6. recorded_references  ",
        "7. recorded_breaches  ",
        "8. Exploit_demo  ",
        "9. Author  ",
        "10. Code_implementation\n",
        "11. Attack_Complexity  ",
        "12. Privilege_Required  ",
        "13. User_Interaction  ",
        "14. Scope  ",
        "15. Confidentiality\n",
        "16. Integrity  ",
        "17. Availability  ",
        "18. Medium  ",
        "19. OS  ",
        "20. Version  ",
    )
    column = input("Enter the value you would like to update: ")

    table = "Not Entered"
    updates = "Not Entered"
    if column == "1":
        updates = input("Enter the updated CVE-ID: ")
        column = "ID"
        table = "CVE_ID"
    elif column == "2":
        updates = input("Enter the updated Name: ")
        column = "Name"
        table = "CVE_ID"
    elif column == "3":
        updates = input("Enter the updated Method of Entry: ")
        column = "Method_of_entry"
        table = "CVE_Scores"
    elif column == "4":
        updates = input("Enter the updated Attack Vector: ")
        column = "Attack_Vector_v3"
        table = "CVE_Scores"
    elif column == "5":
        updates = input("Enter the updated Text Description: ")
        column = "text_description"
        table = "Description"
    elif column == "6":
        updates = input("Enter the updated Recorded References: ")
        column = "recorded_references"
        table = "Description"
    elif column == "7":
        updates = input("Enter the updated number of Recorded Breaches: ")
        column = "recorded_breaches"
        table = "Description"
    elif column == "8":
        updates = input("Enter the updated Exploit Demo: ")
        column = "Exploit_demo"
        table = "Proof_Of_Exploit"
    elif column == "9":
        updates = input("Enter the updated Author: ")
        column = "Author"
        table = "Proof_Of_Exploit"
    elif column == "10":
        updates = input("Enter the updated Code Implementation: ")
        column = "Code_implementation"
        table = "Proof_Of_Exploit"
    elif column == "11":
        updates = input("Enter the updated Attack Complexity: ")
        column = "Attack_Copmlexity"
        table = "Sub_Scores"
    elif column == "12":
        updates = input("Enter the updated Privilege Required: ")
        column = "Privilege_Required"
        table = "Sub_Scores"
    elif column == "13":
        updates = input("Enter the updated User Interaction required: ")
        column = "User_Interaction"
        table = "Sub_Scores"
    elif column == "14":
        updates = input("Enter the updated Scope: ")
        column = "Scope"
        table = "Sub_Scores"
    elif column == "15":
        updates = input("Enter the updated Confidentiality: ")
        column = "Confidentiality"
        table = "Sub_Scores"
    elif column == "16":
        updates = input("Enter the updated Integrity: ")
        column = "Integrity"
        table = "Sub_Scores"
    elif column == "17":
        updates = input("Enter the updated Availability: ")
        column = "Availability"
        table = "Sub_Scores"
    elif column == "18":
        updates = input("Enter the updated Medium: ")
        column = "Medium"
        table = "vulnerable_appliances"
    elif column == "19":
        updates = input("Enter the updated OS: ")
        column = "OS"
        table = "vulnerable_appliances"
    elif column == "20":
        updates = input("Enter the updated Version: ")
        column = "Version"
        table = "vulnerable_appliances"
    with get_db_connection() as conn:
        update_entry(conn, table, column, cve_id, updates)


def return_to_menu():
    print("Returning to Menu...\n\n")
    return True


def display_menu():
    print("Choose your modification option")
    print("1. Update CVE")
    print("0. Exit")


def updatecve_menu():
    menu_options = {
        "1": option_1,
        "0": return_to_menu,
    }

    while True:
        display_menu()
        choice = input("Enter your choice (1 or 0 to exit): ")

        if choice in menu_options:
            should_exit = menu_options[choice]()
            if should_exit:
                break
        else:
            print_red("Invalid choice. Please choose a number from 0 to 1.\n")
